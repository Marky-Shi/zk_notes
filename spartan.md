![spartan-workflow](./spartan-workflow.webp)



> ### é¢„å¤‡çŸ¥è¯†
>
> **GKR**ï¼ˆGoldwasser-Kalai-Rothblumï¼‰æ˜¯ä¸€ç§é›¶çŸ¥è¯†è¯æ˜Žåè®®ï¼Œç”¨äºŽéªŒè¯æŸæ–¹æ‹¥æœ‰æŸäº›ä¿¡æ¯ï¼Œè€Œä¸æ³„éœ²å…·ä½“æ•°æ®å†…å®¹ã€‚å…·ä½“æ¥è¯´ï¼Œ**GKR** åè®®æ˜¯ **Sumcheck** åè®®çš„ä¸€ç§åº”ç”¨ï¼Œ**ç”¨äºŽè¯æ˜Žå¤šä¸ªç”µè·¯çš„è¾“å‡ºç»“æžœ**ã€‚
>
> æ•°æ®å¹¶è¡ŒåŒ–ä¸‹çš„GKRåè®®ï¼š
>
> 1. æ•°æ®å¹¶è¡ŒåŒ–GKRï¼š
>    1. åœ¨æ•°æ®å¹¶è¡ŒåŒ–ä¸‹ï¼ŒåŒä¸€ä¸ªç”µè·¯æè¿°åº”ç”¨åœ¨å¤šç»„è¾“å…¥æ•°æ®ä¸­çš„ **GKR** åè®®ã€‚
>    2. åœ¨GKRåè®®ä¸­ï¼Œproveéœ€è¦è¯æ˜Žçš„**ä¸å†æ˜¯å•ä¸€çš„ç”µè·¯è¾“å‡ºï¼Œè€Œæ˜¯å¤šä¸ªå­ç”µè·¯çš„è¾“å‡ºçš„æ±‡æ€»ã€‚**
> 2. åè®®æ­¥éª¤ï¼š
>    1. Step Zeroï¼š public inputs ä»¥åŠ witness æäº¤
>    2. Step Oneï¼šProver å‘é€ç”µè·¯çš„**outputsä½œä¸º Sumcheck çš„åˆå§‹å£°æ˜Žï¼Œ**Verifer æ ¹æ®ç»™å®šç”µè·¯ç¬¬ 0 å±‚çš„è¯„ä¼°å€¼æ’å€¼å‡ºç›¸åº”çš„å¤šé¡¹å¼**ã€‚
>    3. Step Twoï¼š è¿›å…¥ç¬¬ 1 å±‚ç”µè·¯çš„ Sumcheck åè®®ï¼Œ**Prover éœ€è¦è¯æ˜Žå¤šé¡¹å¼çš„æ­£ç¡®æ€§**ã€‚
>    4. Step Threeï¼š ç»§ç»­è¿›è¡Œå¤šè½®çš„éªŒè¯ï¼Œç›´åˆ°æœ€åŽä¸€è½®ã€‚
>    5. Last Roundï¼š Verifer ä½¿ç”¨å¤šé¡¹å¼çš„ commitment å®Œæˆç¬¬ 1 å±‚ç”µè·¯ Sumcheck åè®®çš„æœ€åŽéªŒè¯ã€‚
>
> SumCheck ä¸€ç§ç”¨äºŽé›¶çŸ¥è¯†è¯æ˜Žçš„äº¤äº’å¼åè®®ã€‚
>
> [ä¸€æ–‡äº†è§£é›¶çŸ¥è¯†è¯æ˜Žå½“ä¸­çš„ Sum-check Protocol - Foresight News](https://foresightnews.pro/article/detail/24351)



SPartan æ˜¯ä¸€ç§æ–°åž‹çš„zk-snarkæŠ€æœ¯ï¼Œä»–æ˜¯ä¸€ç§æ¦‚æ‹¬ç®—æœ¯å¯æ»¡è¶³è¡Œçš„npå®Œå¤‡è¯­è¨€ã€‚

Spartan çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºŽï¼š

* **æ— éœ€ä¿¡ä»»çš„è®¾ç½®**ï¼šSpartan æ˜¯ä¸€ç§é€æ˜Žçš„ zkSNARKï¼Œä¸éœ€è¦ä¿¡ä»»çš„è®¾ç½®ã€‚å› æ­¤ï¼Œå®ƒä¸æ¶‰åŠä»»ä½•å¿…é¡»ä¿å¯†çš„é™·é˜±é—¨ï¼Œä¹Ÿä¸éœ€è¦å¤šæ–¹ä»ªå¼æ¥äº§ç”Ÿå…¬å…±å‚æ•°

* **é€šç”¨æ€§**ï¼šSpartan å¯ä»¥ä¸ºä»»æ„ NP è¯­å¥ç”Ÿæˆè¯æ˜Žã€‚libspartan æ”¯æŒä»¥ R1CS å®žä¾‹è¡¨è¾¾çš„ NP è¯­å¥ï¼Œè¿™æ˜¯ä¸€ç§æµè¡Œçš„è¯­è¨€ï¼Œå­˜åœ¨ä»Žé«˜çº§ç¨‹åºåˆ°æ„Ÿå…´è¶£çš„ç¨‹åºçš„é«˜æ•ˆè½¬æ¢å’Œç¼–è¯‘å·¥å…·é“¾

* **æ¬¡çº¿æ€§éªŒè¯æˆæœ¬**ï¼šSpartan æ˜¯ç¬¬ä¸€ä¸ªå¯¹äºŽä»»æ„ NP è¯­å¥ï¼ˆä¾‹å¦‚ï¼ŒR1CSï¼‰å…·æœ‰æ¬¡çº¿æ€§éªŒè¯æˆæœ¬çš„é€æ˜Žè¯æ˜Žç³»ç»Ÿ3ã€‚

* **æ ‡å‡†åŒ–çš„å®‰å…¨æ€§**ï¼šSpartan çš„å®‰å…¨æ€§ä¾èµ–äºŽåœ¨éšæœºé¢„è¨€æ¨¡åž‹ä¸­è®¡ç®—ç¦»æ•£å¯¹æ•°çš„éš¾åº¦3ã€‚

  

  åœ¨é€æ˜Ž SNARKs ä¸­ï¼ŒSpartan æä¾›äº†æœ€å¿«çš„è¯æ˜Žè€…ï¼Œæ ¹æ®åŸºçº¿ï¼Œé€Ÿåº¦æé«˜äº† 36-152 å€ï¼Œç”Ÿæˆçš„è¯æ˜Žæ›´çŸ­ï¼Œä¸º 1.2-416 å€ï¼Œå¹¶ä¸”éªŒè¯æ—¶é—´æœ€ä½Žï¼Œé€Ÿåº¦æé«˜äº† 3.6-1326 å€



Spartanåœ¨é›¶çŸ¥è¯†è¯æ˜Žï¼ˆZKPï¼‰ä¸­çš„å®žçŽ°ï¼Œä¸»è¦ä¾èµ–äºŽä»¥ä¸‹å‡ ç§æ–°çš„æŠ€æœ¯ï¼Œè¾¾åˆ°**æ— éœ€å¯ä¿¡è®¾ç½®**çš„ç›®çš„ï¼š

* **è®¡ç®—æ‰¿è¯º**ï¼ˆComputation Commitmentsï¼‰ï¼šè¿™æ˜¯ä¸€ç§åˆ›å»ºå¯¹è®¡ç®—æè¿°çš„ç®€æ´æ‰¿è¯ºçš„åŽŸè¯­ã€‚è¿™ç§æŠ€æœ¯å¯¹äºŽéªŒè¯è€…åœ¨æŠ•å…¥ä¸€æ¬¡æ€§çš„å…¬å…±è®¡ç®—æ¥é¢„å¤„ç†ç»™å®šçš„NPè¯­å¥åŽå®žçŽ°æ¬¡çº¿æ€§æˆæœ¬è‡³å…³é‡è¦ã€‚
* **SPARK**ï¼šè¿™æ˜¯ä¸€ç§å¯†ç å­¦ç¼–è¯‘å™¨ï¼Œç”¨äºŽå°†ä»»ä½•çŽ°æœ‰çš„å¯æå–çš„å¤šé¡¹å¼æ‰¿è¯ºæ–¹æ¡ˆè½¬æ¢ä¸ºæœ‰æ•ˆå¤„ç†ç¨€ç–å¤šé¡¹å¼çš„æ–¹æ¡ˆã€‚è¿™ç§æŠ€æœ¯å¯¹äºŽå®žçŽ°æ—¶é—´æœ€ä¼˜è¯æ˜Žè€…è‡³å…³é‡è¦ã€‚
* **R1CSå®žä¾‹çš„ç´§å‡‘ç¼–ç **ï¼šå°†R1CSå®žä¾‹ç¼–ç ä¸ºä½Žåº¦å¤šé¡¹å¼ã€‚
  æœ€ç»ˆçš„ç»“æžœæ˜¯ä¸€ä¸ªå…¬å¸çš„ç®€æ´çš„äº¤äº’å¼çŸ¥è¯†è®ºè¯ï¼Œç”¨äºŽNPï¼ˆå¯ä»¥è§†ä¸ºsum-checkåè®®çš„ç®€æ´å˜ä½“ï¼‰ï¼›æˆ‘ä»¬ä½¿ç”¨å…ˆå‰çš„æŠ€æœ¯å°†å…¶è½¬æ¢ä¸ºzkSNARK1[1]22ã€‚

é€šè¿‡å°†SPARKåº”ç”¨äºŽä¸åŒçš„æ‰¿è¯ºæ–¹æ¡ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†å‡ ä¸ªzkSNARKsï¼Œå…¶ä¸­éªŒè¯è€…çš„æˆæœ¬å’Œè¯æ˜Žå¤§å°èŒƒå›´ä»ŽO(log2 n)åˆ°O(n)ï¼Œå–å†³äºŽåº•å±‚çš„æ‰¿è¯ºæ–¹æ¡ˆï¼ˆnè¡¨ç¤ºNPè¯­å¥çš„å¤§å°ï¼‰



![spartan](./spartan-å¤šé¡¹å¼æ‰¿è¯º.png)

> è®¡ç®—æ‰¿è¯ºï¼Œä¸€ä¸ªç”¨äºŽåˆ›å»ºç®€æ´çš„åŠ å¯†ç½‘ç»œçš„åŽŸè¯­ï¼Œæäº¤ç»™NPè¯­å¥çš„æ•°å­¦æè¿°ï¼Œè¿™å¯¹äºŽå®žçŽ°äºšçº¿æ€§éªŒè¯æˆæœ¬è‡³å…³é‡è¦ã€‚
>
> åœ¨spartanä¸­ï¼ŒéªŒè¯è€…è¯»å–ä¸€ä¸ªR1CSå®žä¾‹ ï¼ˆæ²¡æœ‰ioç»„ä»¶ï¼‰ï¼Œä¸ºæ­¤äº§ç”Ÿäº†è¯æ˜Žï¼Œå¹¶ä¿ç•™äº†å¯¹ä¸€ç»„ç¨€ç–å¤šçº¿æ€§å¤šé¡¹å¼ç¼–ç R1CSç»“æž„çš„çŸ­å¯†ç æ‰¿è¯ºã€‚
>
> ç„¶åŽï¼Œåœ¨äº§ç”Ÿä¸€ä¸ªè¯æ˜Žæ—¶ï¼Œè¯æ˜Žè€…è®¡ç®—å¿…è¦çš„å¤šé¡¹å¼ï¼Œå¹¶è¯æ˜Žç¨€ç–å¤šé¡¹å¼è®¡ç®—ä¸ŽéªŒè¯è€…ä¿ç•™çš„æ‰¿è¯ºæ˜¯ä¸€è‡´çš„ã€‚è€Œ éªŒè¯è€…åœ¨è®¡ç®—è®¡ç®—æ‰¿è¯ºæ—¶äº§ç”ŸO (n)æˆæœ¬ï¼Œæˆæœ¬æ‘Šé”€ä¸ºæ‰€æœ‰å…·æœ‰ç›¸åŒç»“æž„çš„R1CSå®žä¾‹äº§ç”Ÿçš„æ‰€æœ‰æœªæ¥è¯æ˜Žã€‚è¿™ç§æ‘Šé”€ç±»ä¼¼äºŽé‚£ä¸ª GGPR ã€‚ç„¶è€Œï¼Œä¸ŽGGPRçš„å¯ä¿¡è®¾ç½®ä¸åŒï¼Œåˆ›å»ºä¸€ä¸ªè®¡ç®—æ‰¿è¯ºä¸æ¶‰åŠä»»ä½•secret trapdoors.
>
> SPARKï¼Œ**ä¸€ç§å¯†ç ç¼–è¯‘å™¨**ï¼Œå°†ä»»ä½•çŽ°æœ‰çš„å¤šçº¿æ€§å¤šé¡¹å¼æ‰¿è¯ºæ–¹æ¡ˆè½¬æ¢ä¸ºä¸€ä¸ªæœ‰æ•ˆå¤„ç†ç¨€ç–å¤šçº¿æ€§å¤šé¡¹å¼çš„æ–¹æ¡ˆ
>
> ä¸€ä¸ªR1CSå®žä¾‹çš„**ç´§å‡‘ç¼–ç **ä¸ºä¸€ä¸ª3æ¬¡å¤šå…ƒå¤šé¡¹å¼ï¼Œå¯ä»¥åˆ†è§£ä¸ºå››ä¸ªå¤šçº¿æ€§å¤šé¡¹å¼ã€‚åˆ†è§£æˆå¤šçº¿æ€§å¤šé¡¹å¼æ˜¯å¯¹a åˆ©ç”¨å…ˆéªŒæ€æƒ³ï¼Œåœ¨æ±‚å’Œæ ¡éªŒåè®®ä¸­å¾—åˆ°ä¸€ä¸ªæ—¶é—´æœ€ä¼˜è¯æ˜Žå™¨ã€‚
>
> **Spark** æ˜¯Spartan æ•´ä¸ªåè®®çš„core partï¼Œ**Memory Check**æ˜¯Spark çš„core partï¼Œè€Œ**VSM**åˆæ˜¯Memory Checkæˆ–è€…Spiceçš„core partã€‚
>
> VSMï¼Œå…¨ç§°**Verifiable State Machine**ï¼Œè¿™ä¸ªæ¦‚å¿µæºè‡ªSpiceã€‚
>
> æŠŠä»»ä½•ä¸€ä¸ªstorage å¯¹è±¡å½“ä½œä¸€ä¸ªState Machineï¼Œåœ¨è¿™ä¸ªState Machineä¸Šçš„ä»»ä½•operation å¯¼è‡´å…¶state çš„transition éƒ½å¯ä»¥ç”Ÿæˆç›¸åº”çš„proof ç»™verifier éªŒè¯ã€‚è¿™å°±æ˜¯æ‰€è°“çš„Verifiable State Machineã€‚
>
> ![vsm](./vsm in spartan.webp)
>
> TIPS:
>
> - Spice æœ‰ä¸¤ä¸ªdrawback æˆ–è€…ç‰¹æ€§ï¼šå…¶ä¸€ï¼Œ**æ‰¹é‡éªŒè¯**ï¼Œä¹Ÿå°±æ˜¯n ä¸ªoperationä¹‹åŽä¸€èµ·éªŒè¯ï¼Œæˆæœ¬ä¼š**å¹³æ‘Š**åˆ°æ¯ä¸ªoperationä¸Šï¼Œæ‰€ä»¥æˆæœ¬ä¼šå¾ˆä½Žï¼Œä½†ä¼šæœ‰æ—¶é—´ä¸Šçš„delayï¼›å…¶äºŒï¼Œå¦‚æžœéªŒè¯ä¸é€šè¿‡ï¼Œæ˜¯æ— æ³•åˆ¤æ–­å“ªä¸ªoperation å‡ºçš„é—®é¢˜
>
> - Storage ä½œä¸ºä¸‰æ–¹ä¸€ä¸ªç‹¬ç«‹å­˜åœ¨çš„ä¸ªä½“ï¼Œstate é€šå¸¸ä»¥**key-value-timestamp**çš„æ ¼å¼å‡ºçŽ°ï¼Œå®ƒç›¸æ¯”ä¼ ç»Ÿçš„key-value çš„Storage çš„åŒºåˆ«å°±æ˜¯åŠ äº†ä¸€ä¸ªå¯ä»¥**è¡¨å¾State Machineçš„éžå¸¸å…³é”®å…ƒç´ Timestamp**
>
> - Prover è‡ªèº«ç»´æŠ¤ä¸¤ä¸ªset state ð‘…ð‘†*RS* å’Œ ð‘Šð‘†*W**S*ï¼Œå‘é€ä¸€ä¸ªquery/read operation ä¼šæ›´æ–°æœ¬åœ°çš„è¿™ä¸¤ä¸ªset state ð‘…ð‘†*RS* å’Œ ð‘Šð‘†*W**S*ï¼Œå¹¶update Storageçš„state ð´ð‘¢ð‘‘ð‘–ð‘¡*A**u**d**i**t* ï¼Œå‘é€ä¸€ä¸ªwrite operation ä¼šæ›´æ–°æœ¬åœ°çš„state ð‘Šð‘†*W**S*ï¼Œå¹¶update Storage çš„state ð´ð‘¢ð‘‘ð‘–ð‘¡*A**u**d**i**t*
>
> - Verifier æ‹¿ç€æ›´æ–°å‰çš„state ð¼ð‘›ð‘–ð‘¡*I**ni**t*ï¼Œå’Œæ›´æ–°åŽçš„state ð´ð‘¢ð‘‘ð‘–ð‘¡*A**u**d**i**t*ï¼Œä»¥åŠoperaton è¿‡ç¨‹äº§ç”Ÿçš„ä¸­é—´state æˆ–è€…proof ð‘…ð‘†/ð‘Šð‘†*RS*/*W**S*ï¼Œè¿›è¡Œæœ€åŽçš„éªŒè¯ï¼ŒéªŒè¯é€šè¿‡è¯´æ˜Žè¿”å›žçš„ç»“æžœæ²¡æœ‰é—®é¢˜ã€‚
>
> memory check for spartan
>
> Spice æ”¯æŒè¯»ã€å†™æ“ä½œçš„éªŒè¯ï¼Œè€ŒSpark ä¸­åªéœ€è¦å…·å¤‡lookup åŠŸèƒ½çš„éªŒè¯ï¼Œæ‰€ä»¥å¯ä»¥ç®€å•ç†è§£ä¸ºread-only ç‰ˆæœ¬çš„Spiceã€‚
>
> query çš„è¿‡ç¨‹ï¼šç»™å®šð‘Ÿð‘œð‘¤ð‘Žð‘‘ð‘‘ð‘Ÿ/ð‘ð‘œð‘™ð‘Žð‘‘ð‘‘ð‘Ÿ*ro**w**a**dd**r*/*co**l**a**dd**r* å‘é‡ä¸­çš„æŸä¸ªå…ƒç´ å€¼ï¼Œè¿”å›žç›¸åº”table ä¸­evaluationå€¼ã€‚
>
> æ‰¹é‡query ä¹‹å‰ï¼Œverifier è¯·æ±‚æ‹¿åˆ°ð‘šð‘’ð‘šð‘Ÿð‘œð‘¤*m**e**m**ro**w* çš„åˆå§‹State ð¼ð‘›ð‘–ð‘¡ð‘Ÿð‘œð‘¤*I**ni**t**ro**w*ï¼›æ‰¹é‡query ð‘Žð‘‘ð‘‘ð‘Ÿð‘Ÿð‘œð‘¤. verifier è¯·æ±‚å¾—åˆ°ð‘šð‘’ð‘šð‘Ÿð‘œð‘¤*m**e**m**ro**w* çš„æœ€æ–°State ð´ð‘¢ð‘‘ð‘–ð‘¡ð‘Ÿð‘œð‘¤*A**u**d**i**t**ro**w*ï¼Œå†ç»“åˆprover ä¼ é€’è¿‡æ¥çš„proof ð‘…ð‘†ð‘Ÿð‘œð‘¤/ð‘Šð‘†ð‘Ÿð‘œð‘¤*R**S**ro**w*/*W**S**ro**w* è¿›è¡Œæœ€åŽçš„éªŒè¯ï¼š
> $$
> ð¼ð‘›ð‘–ð‘¡ð‘Ÿð‘œð‘¤âˆªð‘Šð‘†ð‘Ÿð‘œð‘¤=?ð´ð‘¢ð‘‘ð‘–ð‘¡ð‘Ÿð‘œð‘¤âˆªð‘…ð‘†ð‘Ÿð‘œð‘¤*Init**ro**w*âˆª*W**S**row*=?*Auditrow*âˆªR**Srow*
> $$
> PS:
>
> * Sparkä¸å†ç”¨çŸ©é˜µè¡¨è¾¾äº†ï¼Œè€Œæ˜¯æ¢ä½œä¸‰ä¸ªå‘é‡æ¥è¡¨è¾¾
> * Spark æ”¹å˜äº†MLE evaluation çš„å¤šé¡¹å¼
>





